<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matematrici</title>
    <link rel="stylesheet" href="style.css">
<script>
        document.getElementById('mathjax-loading-bar').style.width = '20%';

        // MathJax configuration
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']]
            },
            svg: {
                fontCache: 'global'
            },
            startup: {
                pageReady: () => {
                    // Update progress to 60% when MathJax starts processing
                    document.getElementById('mathjax-loading-bar').style.width = '60%';
                    
                    return MathJax.startup.defaultPageReady().then(() => {
                        // Complete the progress bar
                        document.getElementById('mathjax-loading-bar').style.width = '100%';
                        
                        // Wait a moment, then hide loading and show content
                        setTimeout(() => {
                            document.body.classList.add('content-loaded');
                        }, 500);
                    });
                }
            }
        };

        // Update progress as MathJax loads
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('mathjax-loading-bar').style.width = '40%';
        });

</script>
</head>
<body>
<body>
    <div class="loading-container">
        <div class="spinner"></div>
        <div class="progress-container">
            <div id="mathjax-loading-bar"></div>
        </div>
        <div class="loading-text">Loading MathJax...</div>
    </div>

    <div class="main-content" style="display: none;">
    <div class="app-container">
        <div class="header">
            <h1>üìö Carduri Flash MatematicƒÉ</h1>
            <p>√énva»õƒÉ conceptele matematice pas cu pas</p>
        </div>

        <div id="topic-screen" class="content">
            <div class="topic-grid">
                <button class="topic-button" onclick="selectTopic('derivatives')">
                    <span class="topic-icon">üìê</span>
                    <span>Derivate</span>
                </button>
                <button class="topic-button" onclick="selectTopic('integrals')">
                    <span class="topic-icon">‚à´</span>
                    <span>Integrale</span>
                </button>
                <button class="topic-button" onclick="selectTopic('limits')">
                    <span class="topic-icon">‚Üí</span>
                    <span>Limite</span>
                </button>
                <button class="topic-button" onclick="selectTopic('trigonometry')">
                    <span class="topic-icon">üìä</span>
                    <span>Trigonometrie</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Logaritmi')">
                    <span class="topic-icon">üìä</span>
                    <span>Logaritmi</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Matrici')">
                    <span class="topic-icon">üìä</span>
                    <span>Matrici</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Determinanti')">
                    <span class="topic-icon">üìä</span>
                    <span>Determinanti</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Monotonie')">
                    <span class="topic-icon">üìä</span>
                    <span>Monotonie</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Puteri')">
                    <span class="topic-icon">üìä</span>
                    <span>Puteri</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Combinatorica')">
                    <span class="topic-icon">üìä</span>
                    <span>Combinatorica</span>
                </button>
                <button class="topic-button" onclick="selectTopic('Aranjamente')">
                    <span class="topic-icon">üìä</span>
                    <span>Aranjamente</span>
                </button>
                <button class="topic-button" onclick="selectTopic('mixed')">
                    <span class="topic-icon">üé≤</span>
                    <span>Test Mixt</span>
                </button>
            </div>
        </div>

        <div id="flashcard-screen" class="content hidden">
            <div class="flashcard-container">
                <div class="card-counter">
                    <span id="current-card">1</span> din <span id="total-cards">0</span>
                </div>
                
                <div class="flashcard" id="flashcard" onclick="flipCard()">
                    <div class="card-content" id="card-content"></div>
                    <div class="tap-hint">ApasƒÉ pentru a √Æntoarce</div>
                </div>
                
                <div class="controls">
                    <button class="btn btn-secondary" id="prev-btn" onclick="previousCard()">
                        ‚Üê Anterior
                    </button>
                    <button class="btn" id="next-btn" onclick="nextCard()">
                        UrmƒÉtorul ‚Üí
                    </button>
                </div>
                
                <div class="controls">
                    <button class="btn btn-secondary" onclick="backToTopics()">
                        ‚Üê √énapoi la Subiecte
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        // Replace the old flashcards object with the new database
        const database = {
            "topics": [
                { "id": 1, "nume": "Derivate" },
                { "id": 2, "nume": "Integrale" },
                { "id": 3, "nume": "Limite" },
                { "id": 4, "nume": "Trigonometrie" },
                { "id": 5, "nume": "Logaritmi" },
                { "id": 6, "nume": "Matrici" },
                { "id": 7, "nume": "Determinanti" },
                { "id": 8, "nume": "Monotonie" },
                { "id": 9, "nume": "Puteri" },
                { "id": 10, "nume": "Combinatorica" },
                { "id": 11, "nume": "Aranjamente" }
            ],
            "flashcards": [
                { "id": 101, "topic_id": 1, "front_text": "Care este derivata functiei $x^n$?", "back_text": "$$n x^{n-1}$$", "type": "formula" },
                { "id": 102, "topic_id": 1, "front_text": "Derivata lui $\\sqrt{x}$?", "back_text": "$$\\frac{1}{2\\sqrt{x}}$$", "type": "formula" },
                { "id": 103, "topic_id": 1, "front_text": "Derivata lui $\\frac{1}{x}$?", "back_text": "$$-\\frac{1}{x^2}$$", "type": "formula" },
                { "id": 104, "topic_id": 1, "front_text": "Derivata functiei $\\ln|x|$?", "back_text": "$$\\frac{1}{x}$$", "type": "formula" },
                { "id": 105, "topic_id": 1, "front_text": "Formula derivarii functiei compuse?", "back_text": "$$(f\\circ g)'(x) = f'(g(x)) g'(x)$$", "type": "teorema" },
                { "id": 106, "topic_id": 1, "front_text": "Derivata functiei $\\sec(x)$?", "back_text": "$$\\sec(x)\\tan(x)$$", "type": "formula" },
                { "id": 107, "topic_id": 1, "front_text": "Derivata functiei $\\csc(x)$?", "back_text": "$$-\\csc(x)\\cot(x)$$", "type": "formula" },
                { "id": 108, "topic_id": 1, "front_text": "Derivata functiei $\\sin(x)$?", "back_text": "$$\\cos(x)$$", "type": "formula" },
                { "id": 109, "topic_id": 1, "front_text": "Derivata functiei $\\cos(x)$?", "back_text": "$$-\\sin(x)$$", "type": "formula" },
                { "id": 110, "topic_id": 1, "front_text": "Derivata functiei $e^x$?", "back_text": "$$e^x$$", "type": "formula" },
                { "id": 111, "topic_id": 1, "front_text": "Derivata functiei $a^x$?", "back_text": "$$a^x \\ln(a)$$", "type": "formula" },
                { "id": 112, "topic_id": 1, "front_text": "Derivata functiei $\\tan(x)$?", "back_text": "$$\\sec^2(x)$$", "type": "formula" },
                { "id": 113, "topic_id": 1, "front_text": "Derivata functiei $\\cot(x)$?", "back_text": "$$-\\csc^2(x)$$", "type": "formula" },
                { "id": 114, "topic_id": 1, "front_text": "Regula produsului pentru derivare?", "back_text": "$$(f\\cdot g)' = f' g + f g'$$", "type": "teorema" },
                { "id": 115, "topic_id": 1, "front_text": "Regula catului pentru derivare?", "back_text": "$$(\\frac{f}{g})' = \\frac{f'g - fg'}{g^2}$$", "type": "teorema" },
                { "id": 116, "topic_id": 1, "front_text": "Derivata functiei $\\ln(f(x))$?", "back_text": "$$\\frac{f'(x)}{f(x)}$$", "type": "formula" },
                { "id": 117, "topic_id": 1, "front_text": "Derivata functiei $\\arcsin(x)$?", "back_text": "$$\\frac{1}{\\sqrt{1-x^2}}$$", "type": "formula" },
                { "id": 118, "topic_id": 1, "front_text": "Derivata functiei $\\arccos(x)$?", "back_text": "$$-\\frac{1}{\\sqrt{1-x^2}}$$", "type": "formula" },
                { "id": 119, "topic_id": 1, "front_text": "Derivata functiei $\\arctan(x)$?", "back_text": "$$\\frac{1}{1+x^2}$$", "type": "formula" },
                { "id": 120, "topic_id": 1, "front_text": "Derivata functiei $\\arccot(x)$?", "back_text": "$$-\\frac{1}{1+x^2}$$", "type": "formula" },

                { "id": 201, "topic_id": 2, "front_text": "Integrala lui $\\sqrt{x}$?", "back_text": "$$\\frac{2}{3}x^{3/2}+C$$", "type": "formula" },
                { "id": 202, "topic_id": 2, "front_text": "Integrala lui $\\frac{1}{1+x^2}$?", "back_text": "$$\\arctan(x)+C$$", "type": "formula" },
                { "id": 203, "topic_id": 2, "front_text": "Integrala lui $\\sec^2(x)$?", "back_text": "$$\\tan(x)+C$$", "type": "formula" },
                { "id": 204, "topic_id": 2, "front_text": "Integrala lui $\\csc^2(x)$?", "back_text": "$$-\\cot(x)+C$$", "type": "formula" },
                { "id": 205, "topic_id": 2, "front_text": "Integrala lui $e^{ax}$?", "back_text": "$$\\frac{1}{a}e^{ax}+C$$", "type": "formula" },
                { "id": 206, "topic_id": 2, "front_text": "Integrala lui $x^n$ cu $n\\neq -1$?", "back_text": "$$\\frac{x^{n+1}}{n+1}+C$$", "type": "formula" },
                { "id": 207, "topic_id": 2, "front_text": "Integrala lui $\\frac{1}{x}$?", "back_text": "$$\\ln|x|+C$$", "type": "formula" },
                { "id": 208, "topic_id": 2, "front_text": "Integrala lui $\\sin(x)$?", "back_text": "$$-\\cos(x)+C$$", "type": "formula" },
                { "id": 209, "topic_id": 2, "front_text": "Integrala lui $\\cos(x)$?", "back_text": "$$\\sin(x)+C$$", "type": "formula" },
                { "id": 210, "topic_id": 2, "front_text": "Integrala lui $\\tan(x)$?", "back_text": "$$-\\ln|\\cos(x)|+C$$", "type": "formula" },
                { "id": 211, "topic_id": 2, "front_text": "Integrala lui $\\cot(x)$?", "back_text": "$$\\ln|\\sin(x)|+C$$", "type": "formula" },
                { "id": 212, "topic_id": 2, "front_text": "Integrala lui $\\sec(x)\\tan(x)$?", "back_text": "$$\\sec(x)+C$$", "type": "formula" },
                { "id": 213, "topic_id": 2, "front_text": "Integrala lui $\\csc(x)\\cot(x)$?", "back_text": "$$-\\csc(x)+C$$", "type": "formula" },
                { "id": 214, "topic_id": 2, "front_text": "Integrala functiei exponentiale $a^x$?", "back_text": "$$\\frac{a^x}{\\ln a}+C$$", "type": "formula" },
                { "id": 215, "topic_id": 2, "front_text": "Regula integrarii unui produs $u'v$ sau $uv'$?", "back_text": "$$\\int u'v dx = uv - \\int uv' dx$$", "type": "teorema" },
                { "id": 216, "topic_id": 2, "front_text": "Integrala functiei $1/\\sqrt{1-x^2}$?", "back_text": "$$\\arcsin(x)+C$$", "type": "formula" },
                { "id": 217, "topic_id": 2, "front_text": "Integrala functiei $1/(1-x^2)$?", "back_text": "$$\\frac{1}{2}\\ln|\\frac{1+x}{1-x}| + C$$", "type": "formula" },

                { "id": 301, "topic_id": 3, "front_text": "Limita lui $\\frac{\\sin x}{x}$ cand $x \\to 0$?", "back_text": "1", "type": "teorema" },
                { "id": 302, "topic_id": 3, "front_text": "Limita lui $\\frac{1-\\cos x}{x^2}$ cand $x \\to 0$?", "back_text": "$\\frac{1}{2}$", "type": "formula" },
                { "id": 303, "topic_id": 3, "front_text": "Limita lui $(1+\\frac{1}{n})^n$ cand $n\\to\\infty$?", "back_text": "$e$", "type": "formula" },
                { "id": 304, "topic_id": 3, "front_text": "Limita lui $\\ln(x)$ cand $x\\to 0^+$?", "back_text": "$-\\infty$", "type": "formula" },
                { "id": 305, "topic_id": 3, "front_text": "Limita lui $\\frac{e^x-1}{x}$ cand $x\\to 0$?", "back_text": "1", "type": "formula" },

                { "id": 401, "topic_id": 4, "front_text": "Formula adunƒÉrii pentru $\\tan(a+b)$?", "back_text": "$$\\frac{\\tan a + \\tan b}{1-\\tan a \\tan b}$$", "type": "formula" },
                { "id": 402, "topic_id": 4, "front_text": "Formula diferen»õei pentru $\\cos(a-b)$?", "back_text": "$$\\cos a \\cos b + \\sin a \\sin b$$", "type": "formula" },
                { "id": 403, "topic_id": 4, "front_text": "Formula pentru $\\sin^2(x)$?", "back_text": "$$\\frac{1-\\cos(2x)}{2}$$", "type": "formula" },
                { "id": 404, "topic_id": 4, "front_text": "Formula pentru $\\cos^2(x)$?", "back_text": "$$\\frac{1+\\cos(2x)}{2}$$", "type": "formula" },
                { "id": 405, "topic_id": 4, "front_text": "Formula pentru $\\tan(2x)$?", "back_text": "$$\\frac{2\\tan x}{1-\\tan^2x}$$", "type": "formula" },
                { "id": 406, "topic_id": 4, "front_text": "Identitatea $1+\\tan^2x$?", "back_text": "$$\\sec^2x$$", "type": "formula" },
                { "id": 407, "topic_id": 4, "front_text": "Identitatea $1+\\cot^2x$?", "back_text": "$$\\csc^2x$$", "type": "formula" },
                { "id": 408, "topic_id": 4, "front_text": "Formula pentru $\\sin(a-b)$?", "back_text": "$$\\sin a \\cos b - \\cos a \\sin b$$", "type": "formula" },

                { "id": 501, "topic_id": 5, "front_text": "Care este valoarea lui $\\log_e(e)$?", "back_text": "1", "type": "formula" },
                { "id": 502, "topic_id": 5, "front_text": "Care este valoarea lui $\\log_e(1)$?", "back_text": "0", "type": "formula" },
                { "id": 503, "topic_id": 5, "front_text": "Logaritmul unui produs $xy$?", "back_text": "$$\\log_a(xy)=\\log_a x+\\log_a y$$", "type": "formula" },
                { "id": 504, "topic_id": 5, "front_text": "Logaritmul unui cat $x/y$?", "back_text": "$$\\log_a(x/y)=\\log_a x-\\log_a y$$", "type": "formula" },
                { "id": 505, "topic_id": 5, "front_text": "Logaritmul unei puteri $x^n$?", "back_text": "$$n \\cdot \\log_a x$$", "type": "formula" },
                { "id": 506, "topic_id": 5, "front_text": "Logaritm baza $10$ se noteazƒÉ?", "back_text": "$\\log(x)$", "type": "definitie" },
                { "id": 507, "topic_id": 5, "front_text": "Logaritm baza $e$ se noteazƒÉ?", "back_text": "$\\ln(x)$", "type": "definitie" },
                { "id": 508, "topic_id": 5, "front_text": "Formula schimbƒÉrii bazei logaritmului?", "back_text": "$$\\log_a b = \\frac{\\log_c b}{\\log_c a}$$", "type": "formula" },
                { "id": 509, "topic_id": 5, "front_text": "Logaritmul unui radical $\\sqrt[n]{x}$?", "back_text": "$$\\log_a(\\sqrt[n]{x}) = \\frac{1}{n}\\log_a x$$", "type": "formula" },
                { "id": 510, "topic_id": 5, "front_text": "Logaritmul lui $a^b$ cu baza $a$?", "back_text": "$$\\log_a(a^b)=b$$", "type": "formula" },
                { "id": 511, "topic_id": 5, "front_text": "Logaritmul lui $1$ √Æn orice bazƒÉ $a>0$, $a\\neq 1$?", "back_text": "0", "type": "formula" },
                { "id": 512, "topic_id": 5, "front_text": "Logaritmul lui $a$ √Æn baza $a$ ($a>0$, $a\\neq 1$)?", "back_text": "1", "type": "formula" },
                { "id": 513, "topic_id": 5, "front_text": "Domeniul de defini»õie al func»õiei logaritmice $f(x)=\\log_a x$?", "back_text": "$(0, +\\infty)$", "type": "definitie" },
                { "id": 514, "topic_id": 5, "front_text": "Condi»õii pentru bazƒÉ $a$ √Æntr-un logaritm $\\log_a x$?", "back_text": "$a>0,\\ a\\neq 1$", "type": "definitie" },
                { "id": 515, "topic_id": 5, "front_text": "Condi»õii pentru argument $x$ √Æntr-un logaritm $\\log_a x$?", "back_text": "$x>0$", "type": "definitie" },
                { "id": 516, "topic_id": 5, "front_text": "Monotonia func»õiei logaritmice $f(x)=\\log_a x$ pentru $a>1$?", "back_text": "Func»õia este strict crescƒÉtoare.", "type": "definitie" },
                { "id": 517, "topic_id": 5, "front_text": "Monotonia func»õiei logaritmice $f(x)=\\log_a x$ pentru $0<a<1$?", "back_text": "Func»õia este strict descrescƒÉtoare.", "type": "definitie" },
                { "id": 518, "topic_id": 5, "front_text": "Valoarea expresiei $a^{\\log_a x}$?", "back_text": "$x$", "type": "formula" },
                { "id": 519, "topic_id": 5, "front_text": "Valoarea expresiei $\\log_a(a^x)$?", "back_text": "$x$", "type": "formula" },

                { "id": 601, "topic_id": 6, "front_text": "Ce este o matrice transpusƒÉ?", "back_text": "Matricea ob»õinutƒÉ prin interschimbarea liniilor cu coloanele.", "type": "definitie" },
                { "id": 602, "topic_id": 6, "front_text": "Care este inversa unei matrici $A$?", "back_text": "Matricea $A^{-1}$ cu proprietatea $AA^{-1}=I$.", "type": "definitie" },
                { "id": 603, "topic_id": 6, "front_text": "Ce este o matrice ortogonalƒÉ?", "back_text": "O matrice pƒÉtraticƒÉ $A$ pentru care $A^TA=I$.", "type": "definitie" },
                { "id": 604, "topic_id": 6, "front_text": "Ce proprietate are matricea unitate $I$?", "back_text": "Pentru orice $A$, $AI=IA=A$.", "type": "teorema" },
                { "id": 605, "topic_id": 6, "front_text": "Ce este matricea opusƒÉ a lui $A$?", "back_text": "Matricea $-A$, cu elemente $a_{ij}$ negate.", "type": "definitie" },

                { "id": 701, "topic_id": 7, "front_text": "Determinantul matricei unitate $I_n$?", "back_text": "1", "type": "formula" },
                { "id": 702, "topic_id": 7, "front_text": "Ce se √Ænt√¢mplƒÉ cu determinantul daca douƒÉ linii se interschimbƒÉ?", "back_text": "√é»ôi schimbƒÉ semnul.", "type": "teorema" },
                { "id": 703, "topic_id": 7, "front_text": "Determinantul unei matrice cu o linie nulƒÉ?", "back_text": "Determinantul este 0.", "type": "teorema" },
                { "id": 704, "topic_id": 7, "front_text": "Ce se √Ænt√¢mplƒÉ cu determinantul daca o linie este multiplƒÉ a alteia?", "back_text": "Determinantul este 0.", "type": "teorema" },
                { "id": 705, "topic_id": 7, "front_text": "Determinantul unui produs $AB$?", "back_text": "$$\\det(AB)=\\det(A)\\det(B)$$", "type": "teorema" },

                { "id": 801, "topic_id": 8, "front_text": "C√¢nd o func»õie este crescƒÉtoare?", "back_text": "DacƒÉ $f'(x)>0$ pe un interval.", "type": "definitie" },
                { "id": 802, "topic_id": 8, "front_text": "C√¢nd o func»õie este descrescƒÉtoare?", "back_text": "DacƒÉ $f'(x)<0$ pe un interval.", "type": "definitie" },
                { "id": 803, "topic_id": 8, "front_text": "Criteriul de convexitate?", "back_text": "DacƒÉ $f''(x)>0$, func»õia e convexƒÉ.", "type": "teorema" },
                { "id": 804, "topic_id": 8, "front_text": "Criteriul de concavitate?", "back_text": "DacƒÉ $f''(x)<0$, func»õia e concavƒÉ.", "type": "teorema" },
                { "id": 805, "topic_id": 8, "front_text": "Criteriul derivatelor pentru extrem local?", "back_text": "DacƒÉ $f'(x_0)=0$ »ôi $f''(x_0)>0$, $x_0$ este minim; dacƒÉ $f''(x_0)<0$, $x_0$ este maxim.", "type": "teorema" },

                { "id": 901, "topic_id": 9, "front_text": "Formula $(a^m)(a^n)$?", "back_text": "$$a^{m+n}$$", "type": "formula" },
                { "id": 902, "topic_id": 9, "front_text": "Formula $\\frac{a^m}{a^n}$?", "back_text": "$$a^{m-n}$$", "type": "formula" },
                { "id": 903, "topic_id": 9, "front_text": "Formula $(a^m)^n$?", "back_text": "$$a^{mn}$$", "type": "formula" },
                { "id": 904, "topic_id": 9, "front_text": "Formula $(ab)^n$?", "back_text": "$$a^nb^n$$", "type": "formula" },
                { "id": 905, "topic_id": 9, "front_text": "Formula $(\\frac{a}{b})^n$?", "back_text": "$$\\frac{a^n}{b^n}$$", "type": "formula" },

                { "id": 1001, "topic_id": 10, "front_text": "Defini»õia combinƒÉrilor $C(n,k)$?", "back_text": "NumƒÉrul de submul»õimi de $k$ elemente alese din $n$, fƒÉrƒÉ ordine.", "type": "definitie" },
                { "id": 1002, "topic_id": 10, "front_text": "Formula combinƒÉrilor?", "back_text": "$$C(n,k)=\\frac{n!}{k!(n-k)!}$$", "type": "formula" },
                { "id": 1003, "topic_id": 10, "front_text": "Proprietatea simetricƒÉ?", "back_text": "$$C(n,k)=C(n,n-k)$$", "type": "teorema" },
                { "id": 1004, "topic_id": 10, "front_text": "Rela»õia lui Pascal?", "back_text": "$$C(n,k)=C(n-1,k-1)+C(n-1,k)$$", "type": "teorema" },
                { "id": 1005, "topic_id": 10, "front_text": "C√¢te submul»õimi are o mul»õime cu $n$ elemente?", "back_text": "$$2^n$$", "type": "formula" },

                { "id": 1101, "topic_id": 11, "front_text": "Defini»õia aranjamentelor $A(n,k)$?", "back_text": "NumƒÉrul de moduri de a ordona $k$ elemente alese din $n$.", "type": "definitie" },
                { "id": 1102, "topic_id": 11, "front_text": "Formula aranjamentelor?", "back_text": "$$A(n,k)=\\frac{n!}{(n-k)!}$$", "type": "formula" },
                { "id": 1103, "topic_id": 11, "front_text": "Formula permutƒÉrilor $P_n$?", "back_text": "$n!$", "type": "formula" },
                { "id": 1104, "topic_id": 11, "front_text": "C√¢te permutƒÉri circulare are o mul»õime cu $n$ elemente?", "back_text": "$(n-1)!$", "type": "formula" },
                { "id": 1105, "topic_id": 11, "front_text": "Formula permutƒÉrilor cu repeti»õie pentru $n$ elemente √ÆmpƒÉr»õite √Æn grupuri?", "back_text": "$$\\frac{n!}{n_1!n_2!...n_k!}$$", "type": "formula" }
            ]
        };

        // App state
        let currentTopic = '';
        let currentCards = [];
        let currentCardIndex = 0;
        let isFlipped = false;

        // DOM elements
        const topicScreen = document.getElementById('topic-screen');
        const flashcardScreen = document.getElementById('flashcard-screen');
        const flashcard = document.getElementById('flashcard');
        const cardContent = document.getElementById('card-content');
        const currentCardSpan = document.getElementById('current-card');
        const totalCardsSpan = document.getElementById('total-cards');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');

        function selectTopic(topic) {
            currentTopic = topic;
            currentCardIndex = 0;
            isFlipped = false;
            
            // Prepare cards based on topic
            if (topic === 'mixed') {
                // Mix cards from all topics
                currentCards = shuffleArray([...database.flashcards]).slice(0, 15);
            } else {
                // Convert old topic names to new topic IDs
                const topicMap = {
                    'derivatives': 1,
                    'integrals': 2,
                    'limits': 3,
                    'trigonometry': 4,
                    'Logaritmi': 5,
                    'Matrici': 6,
                    'Determinanti': 7,
                    'Monotonie': 8,
                    'Puteri': 9,
                    'Combinatorica': 10,
                    'Aranjamente': 11
                };
                const topicId = topicMap[topic];
                currentCards = database.flashcards.filter(card => card.topic_id === topicId);
            }
            
            // Update UI
            topicScreen.classList.add('hidden');
            flashcardScreen.classList.remove('hidden');
            
            // Set up the first card
            totalCardsSpan.textContent = currentCards.length;
            showCard();
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function showCard() {
            const card = currentCards[currentCardIndex];
            
            // Reset card state - show QUESTION first
            isFlipped = false;
            flashcard.classList.remove('flipped');
            
            // Show front of card (question) with MathJax
            cardContent.innerHTML = card.front_text;
            MathJax.typesetPromise([cardContent]).catch((err) => console.log(err));
            
            currentCardSpan.textContent = currentCardIndex + 1;
            
            prevBtn.disabled = currentCardIndex === 0;
            nextBtn.disabled = currentCardIndex === currentCards.length - 1;
            
            flashcard.classList.add('bounce');
            setTimeout(() => flashcard.classList.remove('bounce'), 600);
        }

        function flipCard() {
            const card = currentCards[currentCardIndex];
            
            if (!isFlipped) {
                // Show ANSWER (back)
                flashcard.classList.add('flipped');
                cardContent.innerHTML = card.back_text;
                MathJax.typesetPromise([cardContent]).catch((err) => console.log(err));
                isFlipped = true;
            } else {
                // Show QUESTION (front)
                flashcard.classList.remove('flipped');
                cardContent.innerHTML = card.front_text;
                MathJax.typesetPromise([cardContent]).catch((err) => console.log(err));
                isFlipped = false;
            }
        }

        function nextCard() {
            if (currentCardIndex < currentCards.length - 1) {
                currentCardIndex++;
                showCard();
            }
        }

        function previousCard() {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                showCard();
            }
        }

        function backToTopics() {
            flashcardScreen.classList.add('hidden');
            topicScreen.classList.remove('hidden');
            currentTopic = '';
            currentCards = [];
            currentCardIndex = 0;
            isFlipped = false;
        }

        // Touch/swipe support for mobile
        let startX = 0;
        let startY = 0;

        flashcard.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        }, { passive: true });

        flashcard.addEventListener('touchend', (e) => {
            const endX = e.changedTouches[0].clientX;
            const endY = e.changedTouches[0].clientY;
            const deltaX = endX - startX;
            const deltaY = endY - startY;

            // If it's more of a horizontal swipe than vertical
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 80) {
                e.preventDefault();
                if (deltaX > 0 && currentCardIndex > 0) {
                    previousCard();
                } else if (deltaX < 0 && currentCardIndex < currentCards.length - 1) {
                    nextCard();
                }
            }
        }, { passive: false });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (flashcardScreen.classList.contains('hidden')) return;
            
            switch(e.key) {
                case ' ':
                case 'Enter':
                    e.preventDefault();
                    flipCard();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    previousCard();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    nextCard();
                    break;
                case 'Escape':
                    e.preventDefault();
                    backToTopics();
                    break;
            }
        });
    </script>
</body>
</html>